#! /usr/bin/env python3
import gmpy2
#p = 473398607160
import math
p =  9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483
q =  11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407
e =  65537
p = 3
q = 11
e = 3



#q = 4511491
#e = 17
p1 = gmpy2.mpz(p)#初始化大整数
q1 = gmpy2.mpz(q)
e1 = gmpy2.mpz(e)
phi_n = (p1-1)*(q1-1)
d = gmpy2.invert(e1,phi_n)#invert（x，m）返回y使得x * y == 1 modulo m，如果不存在y，则返回0
print("p=%s,q=%s,e=%s"%(p1,q1,e1))
print("d is:\t%s"%d)
m = 4
print("m:"+str(m))
cc = int(math.pow(m,e))%(p*q)
print("公钥加密c: "+str(cc))

cc = int(math.pow(m,d))%(p*q)

print("数字签名s: "+str(cc))


